# Контекст выполнения в JavaScript

Контекст выполнения (Execution Context) в JavaScript — это среда или контекст, в котором выполняется код JavaScript. Он содержит информацию о переменных, функциях и объектах, доступных для исполняемого кода, а также о цепочке областей видимости (Scope Chain) и значении ключевого слова `this`.

Контекст выполнения проходит через две основные фазы: фазу создания и фазу выполнения.

## Фаза создания

На этом этапе движок JavaScript подготавливает среду для выполнения кода. Во время этой фазы движок JavaScript создает:

- **Объект переменных (Variable Object, VO):** Хранит информацию о всех переменных, функциях и объявлениях параметров функций.
- **Цепочку областей видимости (Scope Chain):** Определяет область видимости каждой переменной в текущем контексте выполнения.
- **Ключевое слово `this`:** Определяется на основе контекста, в котором вызывается функция.

### Выделение памяти

Во время фазы создания также происходит выделение памяти для переменных и функций. Переменные и функции "поднимаются" (hoisting), что означает, что они доступны в коде до их объявления.

<span style="color:red;">ReferenceError возникает из-за неправильного обращения к переменным, а не из-за операций с данными или их типов. Это ключевое отличие ошибок, связанных с областью видимости и доступностью переменных, от ошибок, связанных с типами данных или операциями над ними (например, TypeError).
</span>

### Основные аспекты:

- **Присваивание значений переменным:** Значения назначаются переменным, которые были объявлены в фазе создания.
- **Выполнение функций и блоков кода:** Функции вызываются, и их контексты выполнения помещаются на стек вызовов.
- **Управление стеком вызовов:** Управляет порядком выполнения функций, когда одна функция вызывается из другой.

## Компоненты контекста выполнения в JavaScript

В JavaScript контекст выполнения состоит из двух основных компонентов:

1. **Компонент памяти (Memory Component):** Также известен как Куча (Heap). Это место, где хранятся все переменные и функции как объекты в памяти.
   
2. **Компонент кода (Code Component):** Также известен как Стек (Stack). Это место, где выполняется код построчно.




В JavaScript у каждой функции есть семь (7) фаз внутри выполнения контекста (execution context). Вот они:

1. **Создание (Creation)**:
   - На этой фазе JavaScript создает объект переменных (`Variable Object`), устанавливает `this` и создает цепочку областей видимости (`Scope Chain`). Здесь же происходит запись в память всех объявлений переменных (var) и функций (function declaration).

2. **Запуск (Hoisting)**:
   - В этой фазе JavaScript проходит по коду и "поднимает" (hoist) объявления переменных и функций в верхнюю часть контекста выполнения.

3. **Привязка значений (Binding)**:
   - На этой фазе JavaScript устанавливает значения переменных исходя из кода, который выполняется.

4. **Выполнение (Execution)**:
   - Это фаза, во время которой выполняется основной код функции. JavaScript последовательно выполняет операции и выражения в функции.

5. **Выход из функции (Function Exit)**:
   - В конце функции происходит выход из функции, при котором освобождаются ресурсы, выделенные под контекст выполнения функции.

6. **Удаление переменных (Variable Cleanup)**:
   - В этой фазе происходит удаление переменных, объявленных в функции, из памяти.

7. **Удаление контекста выполнения (Context Cleanup)**:
   - На последней фазе контекст выполнения полностью удаляется из памяти, освобождая ресурсы.

Эти фазы обеспечивают правильное выполнение кода и эффективное использование ресурсов памяти в JavaScript.